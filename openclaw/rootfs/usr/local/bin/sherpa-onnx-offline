#!/bin/bash
# Wrapper script for sherpa-onnx-offline with pre-configured Whisper model paths
# OpenClaw calls this binary for voice transcription

# Find the actual sherpa-onnx binary (version-dependent path)
SHERPA_BIN=$(ls /opt/sherpa-onnx-*/bin/sherpa-onnx-offline 2>/dev/null | head -1)

if [ -z "$SHERPA_BIN" ]; then
    echo "Error: sherpa-onnx-offline binary not found in /opt" >&2
    exit 1
fi

exec "$SHERPA_BIN" \
    --whisper-encoder=/opt/whisper-models/small-encoder.onnx \
    --whisper-decoder=/opt/whisper-models/small-decoder.onnx \
    --tokens=/opt/whisper-models/small-tokens.txt \
    "$@"
